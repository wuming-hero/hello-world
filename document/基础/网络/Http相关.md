
## TCP三次握手
### 三次握手过程
* 一次握手 客户端——发送带有SYN标志的数据包——服务端，Client进入syn_sent状态 
* 二次握手 服务端——发送带有SYN/ACK标志的数据包——客户端，服务端进入syn_rcvd 
* 三次握手 客户端——发送带有ACK标志的数据包——服务端，连接就进入Established状态

### 为什么三次
主要是为了建立可靠的通信信道，保证客户端与服务端同时具备发送、接收数据的能力

### 为什么两次不行?
• 防止已失效的请求报文又传送到了服务端，建立了多余的链接，浪费资源

• 两次握手只能保证单向连接是畅通的。(为了实现可靠数据传输， TCP 协议的通信双方， 都必须维
护一个序列号，以标识发送出去的数据包中，哪些是已经被对方收到的。 三次握手的过程即是通信双方相互告知序列号起始值，并确认对方已经收到了序列号起始值的必经步骤;如果只是两次握手，至多只有连接 发起方的起始序列号能被确认， 另一方选择的序列号则得不到确认)

## TCP四次挥手过程
### 四次挥手过程
1. 客户端——发送带有FIN标志的数据包——服务端，关闭与服务端的连接 ，客户端进入FIN-WAIT-1状态 
2. 服务端收到这个FIN，它发回一个ACK，确认序号为收到的序号加1，服务端就进入了CLOSE-WAIT状态 
3. 服务端——发送一个FIN数据包——客户端，关闭与客户端的连接，客户端就进入FIN-WAIT-2状态 
4. 客户端收到这个 FIN，发回 ACK 报文确认，并将确认序号设置为收到序号加1，TIME-WAIT状态

### 为什么四次
因为需要确保客户端与服务端的数据能够完成传输。

### CLOSE-WAIT
这种状态的含义其实是表示在等待关闭

### TIME-WAIT
为了解决网络的丢包和网络不稳定所带来的其他问题，确保连接方能在时间范围内，关闭自己的连接

### 如何查看TIME-WAIT状态的链接数量?
netstat -an |grep TIMEWAIT|wc -l 查看连接数等待timewait状态连接数

### 为什么会TIME-WAIT过多?解决方法是怎样的?
可能原因: 高并发短连接的TCP服务器上，当服务器处理完请求后立刻按照主动正常关闭连接 

解决:负载均衡服务器;Web服务器首先关闭来自负载均衡服务器的连接

## HTTP协议
### HTTP协议1.0、1.1、2.0
* HTTP1.0:服务器处理完成后立即断开TCP连接(无连接)，服务器不跟踪每个客户端也不记录过去的请求(无状态)
* HTTP1.1:KeepAlived长连接避免了连接建立和释放的开销;通过Content-Length来判断当前请求数据是否已 经全部接受(有状态) 
* HTTP2.0:引入二进制数据帧和流的概念，其中帧对数据进行顺序标识;因为有了序列，服务器可以并行的传输数据。
   
#### http1.0和http1.1的主要区别如下:

* 缓存处理:1.1添加更多的缓存控制策略(如:Entity tag，If-Match)
* 网络连接的优化:1.1支持断点续传
* 错误状态码的增多:1.1新增了24个错误状态响应码，丰富的错误码更加明确各个状态
* Host头处理:支持Host头域，不在以IP为请求方标志
* 长连接:减少了建立和关闭连接的消耗和延迟。
   
#### http1.1和http2.0的主要区别:
* 新的传输格式:2.0使用二进制格式，1.0依然使用基于文本格式
* 多路复用:连接共享，不同的request可以使用同一个连接传输(最后根据每个request上的id号组合成正常的请
   求)
* header压缩:由于1.X中header带有大量的信息，并且得重复传输，2.0使用encoder来减少需要传输的
hearder大小
* 服务端推送:同google的SPDUY(1.0的一种升级)一样

### HTTP与HTTPS之间的区别
端口：http默认端口80，HTTPS默认使用端口443
安全： http POST明文传输、数据未加密、安全性差 ，https传输过程ssl加密、安全性较好
速度： http 响应速度快、消耗资源少 ，https响应速度较慢、消耗资源多、需要用到CA证书

### HTTPS链接建立的过程
* 首先客户端先给服务器发送一个请求
* 服务器发送一个SSL证书给客户端，内容包括:证书的发布机构、有效期、所有者、签名以及公钥 
* 客户端对发来的公钥进行真伪校验，校验为真则使用`公钥对对称加密算法`以及对称密钥进行加密
* 服务器端使用私钥进行解密并使用对称密钥加密确认信息发送给客户端
* 随后客户端和服务端就使用对称密钥进行信息传输
