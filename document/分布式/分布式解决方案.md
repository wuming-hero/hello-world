# CAP
## C：一致性(2PC、3PC、Paxos、Raft)
◦ 强一致性:数据库一致性，牺牲了性能

▪ ACID:原子性、一致性、隔离性、持久性
◦ 弱一致性:数据库和缓存，延迟双删、重试
◦ 单调读一致性:缓存一致性，ID或者IP哈希
◦ 最终一致性:边缘业务，消息队列

### 一致性
#### XA方案
1. 2PC协议:两阶段提交协议，P是指准备阶段，C是指提交阶段
* 准备阶段:询问是否可以开始，写Undo、Redo日志，收到响应
* 提交阶段:执行Redo日志进行Commit，执行Undo日志进行Rollback

3. 3PC协议:
将提交阶段分为CanCommit、PreCommit、DoCommit三个阶段 
* CanCommit:发送canCommit请求，并开始等待 
* PreCommit:收到全部Yes，写Undo、Redo日志。超时或者No，则中断 
* DoCommit:执行Redo日志进行Commit，执行Undo日志进行Rollback 区别是第二步，参与者自身增加了超时，如果失败可以及时释放资源

### Paxos算法
> 分布式系统是一个硬件或软件组件分布在不同的网络计算机上，彼此之间仅仅通过消息传递进行通信和协调的 系统。
>
### ZAB算法

### RAFT 算法



## A:可用性(多级缓存、读写分离)
> 以固定的频率向其他节点汇报当前节点状态的方式。收到心跳，说明网络和节点的状态是健康的。心跳汇报时，一般会携带一些附加的状态、元数据，以便管理

* BASE 基本可用:限流导致响应速度慢、降级导致用户体验差
  * Basically Availabe 基本可用
  * Soft state 软状态
  * Eventual Consistency 最终一致性


## P 
分区容忍性(一致性Hash解决扩缩容问题)
> 分布式系统对于错误包容的能力

通过限流、降级、兜底、重试、负载均衡等方式增强系统的健壮性


